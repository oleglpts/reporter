<?xml version='1.0' encoding='utf-8'?>
<book>
    <report>
        <name>$_title1</name>
        <literal col="0" row="0">Report:</literal>
        <literal col="1" row="0">$_title0</literal>
        <literal col="0" row="1">From:</literal>
        <literal col="1" row="1">$_parm0</literal>
        <literal col="2" row="1">To:</literal>
        <literal col="3" row="1">$_parm1</literal>
        <literal col="4" row="1">Client:</literal>
        <literal col="5" row="1">$_title1</literal>
        <literal col="6" row="1">Bank:</literal>
        <literal col="7" row="1">$_title2</literal>
        <literal col="0" row="3">Currency</literal>
        <literal col="1" row="3">Type</literal>
        <literal col="2" row="3">Number</literal>
        <literal col="3" row="3">Amount</literal>
        <literal col="4" row="3">Captured</literal>
        <literal col="5" row="3">TrFee</literal>
        <literal col="6" row="3">AuFee</literal>
        <literal col="7" row="3">Reserve</literal>
        <literal col="8" row="3">MnFee</literal>
        <literal col="9" row="3">Total</literal>
        <sql cycle="no">
            <request>
                SET TIME ZONE 0;
                SELECT b.currency_short, count(*),sum(a.trans_amount),
                sum(a.client_deposit)::decimal(18,2),sum(a.first_payment),
                sum(a.client_trfee)::decimal(18,2), sum(a.client_authfee)::decimal(18,2)
                FROM transactions AS a JOIN currencies AS b ON(b.currency_code=a.currency_code)
                WHERE a.trans_type=1 AND a.currency_code > 0 AND
                a.status_flag=0 AND
                a.trans_datetime >= '$_parm0'::timestamp with time zone AND
                a.trans_datetime &lt; ('$_parm1'::date + interval '1 day')::timestamp with time zone AND
                a.client_id IN ($_parm2)
                GROUP BY a.currency_code, b.currency_short
                ORDER BY a.currency_code;
            </request>
            <group step="10">
                <field col="0" name="Currency" row="5" header="no"/>
                <groupliteral col="1" name="Type" row="5" header="no">Debit</groupliteral>
                <field col="2" name="Number" row="5" header="no"/>
                <field col="3" name="Amount" row="5" header="no"/>
                <field col="7" name="Reserve" row="5" header="no"/>
                <field col="4" name="Captured" row="5" header="no"/>
                <field col="5" name="TrFee" row="5" header="no"/>
                <field col="6" name="AuFee" row="5" header="no"/>
                <formula col="0" name="Currency" row="13" header="no">INDIRECT("A" &amp; ($_ss+5))</formula>
                <groupliteral col="8" name="MnFee" row="5" header="no">0</groupliteral>
                <formula col="9" name="Total" row="5" header="no">E$_cs-F$_cs-G$_cs-H$_cs-I$_cs</formula>
            </group>
        </sql>
        <sql cycle="yes">
            <request>
                SET TIME ZONE 0;
                SELECT count(*),sum(trans_amount),
                       sum(client_trfee)::decimal(18,2), sum(client_authfee)::decimal(18,2)
                  FROM transactions
                  WHERE trans_type=250 AND status_flag=0 AND currency_code > 0 AND
                    trans_datetime >= '$_parm0'::timestamp with time zone AND
                    trans_datetime &lt; ('$_parm1'::date + interval '1 day')::timestamp with time zone AND
                    client_id IN ($_parm2)
                  GROUP BY currency_code
                  ORDER BY currency_code;
            </request>
            <group step="10">
                <groupliteral col="1" name="Type" row="8" header="no">Refund</groupliteral>
                <field col="2" name="Number" row="8" header="no"/>
                <field col="3" name="Amount" row="8" header="no"/>
                <field col="5" name="TrFee" row="8" header="no"/>
                <field col="6" name="AuFee" row="8" header="no"/>
                <formula col="9" name="Total" row="8" header="no">D$_cs+F$_cs+G$_cs</formula>
            </group>
        </sql>
        <sql cycle="yes">
            <request>
                SET TIME ZONE 0;
                SELECT count(*),sum(trans_amount),
                       sum(client_trfee)::decimal(18,2)
                  FROM transactions
                  WHERE trans_type=249 AND status_flag=0 AND currency_code > 0 AND
                    trans_datetime >= '$_parm0'::timestamp with time zone AND
                    trans_datetime &lt; ('$_parm1'::date + interval '1 day')::timestamp with time zone AND
                    client_id IN ($_parm2)
                  GROUP BY currency_code
                  ORDER BY currency_code;
            </request>
            <group step="10">
                <groupliteral col="1" name="Type" row="11" header="no">Chargeback</groupliteral>
                <field col="2" name="Number" row="11" header="no"/>
                <field col="3" name="Amount" row="11" header="no"/>
                <field col="5" name="TrFee" row="11" header="no"/>
                <formula col="9" name="Total" row="11" header="no">D$_cs+F$_cs</formula>
            </group>
        </sql>
        <sql cycle="yes">
            <request>
                SET TIME ZONE 0;
                SELECT count(*),sum(trans_amount),
                       sum(client_trfee)::decimal(18,2)
                  FROM transactions
                  WHERE trans_type=246 AND status_flag=0 AND currency_code > 0 AND
                    trans_datetime >= '$_parm0'::timestamp with time zone AND
                    trans_datetime &lt; ('$_parm1'::date + interval '1 day')::timestamp with time zone AND
                    client_id IN ($_parm2)
                  GROUP BY currency_code
                  ORDER BY currency_code;
            </request>
            <group step="10">
                <groupliteral col="1" name="Type" row="10" header="no">Fraud</groupliteral>
                <field col="2" name="Number" row="10" header="no"/>
                <field col="3" name="Amount" row="10" header="no"/>
                <field col="5" name="TrFee" row="10" header="no"/>
                <formula col="9" name="Total" row="10" header="no">D$_cs+F$_cs</formula>
            </group>
        </sql>
        <sql cycle="yes">
            <request>
                SET TIME ZONE 0;
                SELECT count(*),sum(trans_amount)
                  FROM transactions
                  WHERE trans_type=245 AND status_flag=0 AND currency_code > 0 AND
                    trans_datetime >= '$_parm0'::timestamp with time zone AND
                    trans_datetime &lt; ('$_parm1'::date + interval '1 day')::timestamp with time zone AND
                    client_id IN ($_parm2)
                  GROUP BY currency_code
                  ORDER BY currency_code;
            </request>
            <group step="10">
                <groupliteral col="1" name="Type" row="12" header="no">CHB refund</groupliteral>
                <field col="2" name="Number" row="12" header="no"/>
                <field col="3" name="Amount" row="12" header="no"/>
                <formula col="9" name="Total" row="12" header="no">D$_cs</formula>
            </group>
        </sql>
        <sql cycle="yes">
            <request>
                SET TIME ZONE 0;
                SELECT count(*), sum(client_deposit)::decimal(18,2)
                FROM transactions
                WHERE trans_type=1 AND currency_code > 0 AND
                status_flag=0 AND
                client_free >= '$_parm0'::timestamp with time zone AND
                client_free &lt; ('$_parm1'::date + interval '1 day')::timestamp with time zone AND
                client_id IN ($_parm2)
                GROUP BY currency_code
                ORDER BY currency_code;
            </request>
            <group step="10">
                <groupliteral col="1" name="Type" row="7" header="no">Reserve refund</groupliteral>
                <field col="2" name="Number" row="7" header="no"/>
                <field col="4" name="Captured" row="7" header="no"/>
                <formula col="9" name="Total" row="7" header="no">E$_cs</formula>
            </group>
        </sql>
        <sql cycle="yes">
            <request>
                SET TIME ZONE 0;
                SELECT sum(cnt), sum(amount), sum(trfee)::decimal(18,2), sum(authfee)
                FROM ((SELECT currency_code, count(*) AS cnt, sum(trans_amount) AS amount,
                sum(client_trfee) AS trfee, sum(client_authfee) AS authfee
                FROM transactions
                WHERE status_flag!=0 AND currency_code > 0 AND
                response_code>0 AND
                trans_datetime >= '$_parm0'::timestamp with time zone AND
                trans_datetime &lt; ('$_parm1'::date + interval '1 day')::timestamp with time zone AND
                client_id IN ($_parm2)
                GROUP BY currency_code
                ORDER BY currency_code
                )
                UNION
                (SELECT currency_code, count(*) AS cnt, sum(trans_amount) AS amount,
                sum(client_trfee) AS trfee, sum(client_decl) AS authfee
                FROM badtransactions
                WHERE trans_datetime >= '$_parm0'::timestamp with time zone AND currency_code > 0 AND
                trans_datetime &lt; ('$_parm1'::date + interval '1 day')::timestamp with time zone AND
                client_id IN ($_parm2)
                GROUP BY currency_code
                ORDER BY currency_code
                )
                ) AS foo
                WHERE currency_code > 0
                GROUP BY currency_code
                ORDER BY currency_code
            </request>
            <group step="10">
                <groupliteral col="1" name="Type" row="9" header="no">Declined</groupliteral>
                <field col="2" name="Number" row="9" header="no"/>
                <field col="3" name="Amount" row="9" header="no"/>
                <field col="5" name="TrFee" row="9" header="no"/>
                <field col="6" name="AuFee" row="9" header="no"/>
                <formula col="9" name="Total" row="9" header="no">F$_cs+G$_cs</formula>
            </group>
        </sql>
        <sql cycle="yes">
            <group step="10">
                <groupliteral col="1" name="Type" row="13" header="no">To transfer</groupliteral>
                <formula col="9" name="Total" row="13" header="no">
                    INDIRECT("J" &amp; ($_ss+5))+
                    INDIRECT("J" &amp; ($_ss+6))+
                    INDIRECT("J" &amp; ($_ss+7))-
                    INDIRECT("J" &amp; ($_ss+8))-
                    INDIRECT("J" &amp; ($_ss+9))-
                    INDIRECT("J" &amp; ($_ss+10))-
                    INDIRECT("J" &amp; ($_ss+11))+
                    INDIRECT("J" &amp; ($_ss+12))
                </formula>
            </group>
        </sql>
    </report>
    <report>
        <name>$_title4</name>
        <literal col="0" row="0">Report:</literal>
        <literal col="1" row="0">$_title3</literal>
        <literal col="0" row="1">From:</literal>
        <literal col="1" row="1">$_parm3</literal>
        <literal col="2" row="1">To:</literal>
        <literal col="3" row="1">$_parm4</literal>
        <literal col="4" row="1">Client:</literal>
        <literal col="5" row="1">$_title4</literal>
        <literal col="6" row="1">Bank:</literal>
        <literal col="7" row="1">$_title5</literal>
        <literal col="0" row="3">Currency</literal>
        <literal col="1" row="3">Type</literal>
        <literal col="2" row="3">Number</literal>
        <literal col="3" row="3">Amount</literal>
        <literal col="4" row="3">Captured</literal>
        <literal col="5" row="3">TrFee</literal>
        <literal col="6" row="3">AuFee</literal>
        <literal col="7" row="3">Reserve</literal>
        <literal col="8" row="3">MnFee</literal>
        <literal col="9" row="3">Total</literal>
        <sql cycle="no">
            <request>
                SET TIME ZONE 0;
                SELECT b.currency_short, count(*),sum(a.trans_amount),
                sum(a.client_deposit)::decimal(18,2),sum(a.first_payment),
                sum(a.client_trfee)::decimal(18,2), sum(a.client_authfee)::decimal(18,2)
                FROM transactions AS a JOIN currencies AS b ON(b.currency_code=a.currency_code)
                WHERE a.trans_type=1 AND a.currency_code > 0 AND
                a.status_flag=0 AND
                a.trans_datetime >= '$_parm3'::timestamp with time zone AND
                a.trans_datetime &lt; ('$_parm4'::date + interval '1 day')::timestamp with time zone AND
                a.client_id IN ($_parm5)
                GROUP BY a.currency_code, b.currency_short
                ORDER BY a.currency_code;
            </request>
            <group step="10">
                <field col="0" name="Currency" row="5" header="no"/>
                <groupliteral col="1" name="Type" row="5" header="no">Debit</groupliteral>
                <field col="2" name="Number" row="5" header="no"/>
                <field col="3" name="Amount" row="5" header="no"/>
                <field col="7" name="Reserve" row="5" header="no"/>
                <field col="4" name="Captured" row="5" header="no"/>
                <field col="5" name="TrFee" row="5" header="no"/>
                <field col="6" name="AuFee" row="5" header="no"/>
                <formula col="0" name="Currency" row="13" header="no">INDIRECT("A" &amp; ($_ss+5))</formula>
                <groupliteral col="8" name="MnFee" row="5" header="no">0</groupliteral>
                <formula col="9" name="Total" row="5" header="no">E$_cs-F$_cs-G$_cs-H$_cs-I$_cs</formula>
            </group>
        </sql>
        <sql cycle="yes">
            <request>
                SET TIME ZONE 0;
                SELECT count(*),sum(trans_amount),
                       sum(client_trfee)::decimal(18,2), sum(client_authfee)::decimal(18,2)
                  FROM transactions
                  WHERE trans_type=250 AND status_flag=0 AND currency_code > 0 AND
                    trans_datetime >= '$_parm3'::timestamp with time zone AND
                    trans_datetime &lt; ('$_parm4'::date + interval '1 day')::timestamp with time zone AND
                    client_id IN ($_parm5)
                  GROUP BY currency_code
                  ORDER BY currency_code;
            </request>
            <group step="10">
                <groupliteral col="1" name="Type" row="8" header="no">Refund</groupliteral>
                <field col="2" name="Number" row="8" header="no"/>
                <field col="3" name="Amount" row="8" header="no"/>
                <field col="5" name="TrFee" row="8" header="no"/>
                <field col="6" name="AuFee" row="8" header="no"/>
                <formula col="9" name="Total" row="8" header="no">D$_cs+F$_cs+G$_cs</formula>
            </group>
        </sql>
        <sql cycle="yes">
            <request>
                SET TIME ZONE 0;
                SELECT count(*),sum(trans_amount),
                       sum(client_trfee)::decimal(18,2)
                  FROM transactions
                  WHERE trans_type=249 AND status_flag=0 AND currency_code > 0 AND
                    trans_datetime >= '$_parm3'::timestamp with time zone AND
                    trans_datetime &lt; ('$_parm4'::date + interval '1 day')::timestamp with time zone AND
                    client_id IN ($_parm5)
                  GROUP BY currency_code
                  ORDER BY currency_code;
            </request>
            <group step="10">
                <groupliteral col="1" name="Type" row="11" header="no">Chargeback</groupliteral>
                <field col="2" name="Number" row="11" header="no"/>
                <field col="3" name="Amount" row="11" header="no"/>
                <field col="5" name="TrFee" row="11" header="no"/>
                <formula col="9" name="Total" row="11" header="no">D$_cs+F$_cs</formula>
            </group>
        </sql>
        <sql cycle="yes">
            <request>
                SET TIME ZONE 0;
                SELECT count(*),sum(trans_amount),
                       sum(client_trfee)::decimal(18,2)
                  FROM transactions
                  WHERE trans_type=246 AND status_flag=0 AND currency_code > 0 AND
                    trans_datetime >= '$_parm3'::timestamp with time zone AND
                    trans_datetime &lt; ('$_parm4'::date + interval '1 day')::timestamp with time zone AND
                    client_id IN ($_parm5)
                  GROUP BY currency_code
                  ORDER BY currency_code;
            </request>
            <group step="10">
                <groupliteral col="1" name="Type" row="10" header="no">Fraud</groupliteral>
                <field col="2" name="Number" row="10" header="no"/>
                <field col="3" name="Amount" row="10" header="no"/>
                <field col="5" name="TrFee" row="10" header="no"/>
                <formula col="9" name="Total" row="10" header="no">D$_cs+F$_cs</formula>
            </group>
        </sql>
        <sql cycle="yes">
            <request>
                SET TIME ZONE 0;
                SELECT count(*),sum(trans_amount)
                  FROM transactions
                  WHERE trans_type=245 AND status_flag=0 AND currency_code > 0 AND
                    trans_datetime >= '$_parm3'::timestamp with time zone AND
                    trans_datetime &lt; ('$_parm4'::date + interval '1 day')::timestamp with time zone AND
                    client_id IN ($_parm5)
                  GROUP BY currency_code
                  ORDER BY currency_code;
            </request>
            <group step="10">
                <groupliteral col="1" name="Type" row="12" header="no">CHB refund</groupliteral>
                <field col="2" name="Number" row="12" header="no"/>
                <field col="3" name="Amount" row="12" header="no"/>
                <formula col="9" name="Total" row="12" header="no">D$_cs</formula>
            </group>
        </sql>
        <sql cycle="yes">
            <request>
                SET TIME ZONE 0;
                SELECT count(*), sum(client_deposit)::decimal(18,2)
                FROM transactions
                WHERE trans_type=1 AND currency_code > 0 AND
                status_flag=0 AND
                client_free >= '$_parm3'::timestamp with time zone AND
                client_free &lt; ('$_parm4'::date + interval '1 day')::timestamp with time zone AND
                client_id IN ($_parm5)
                GROUP BY currency_code
                ORDER BY currency_code;
            </request>
            <group step="10">
                <groupliteral col="1" name="Type" row="7" header="no">Reserve refund</groupliteral>
                <field col="2" name="Number" row="7" header="no"/>
                <field col="4" name="Captured" row="7" header="no"/>
                <formula col="9" name="Total" row="7" header="no">E$_cs</formula>
            </group>
        </sql>
        <sql cycle="yes">
            <request>
                SET TIME ZONE 0;
                SELECT NULL;
                SELECT sum(cnt), sum(amount), sum(trfee)::decimal(18,2), sum(authfee)
                FROM ((SELECT currency_code, count(*) AS cnt, sum(trans_amount) AS amount,
                sum(client_trfee) AS trfee, sum(client_authfee) AS authfee
                FROM transactions
                WHERE status_flag!=0 AND currency_code > 0 AND
                response_code>0 AND
                trans_datetime >= '$_parm3'::timestamp with time zone AND
                trans_datetime &lt; ('$_parm4'::date + interval '1 day')::timestamp with time zone AND
                client_id IN ($_parm5)
                GROUP BY currency_code
                ORDER BY currency_code
                )
                UNION
                (SELECT currency_code, count(*) AS cnt, sum(trans_amount) AS amount,
                sum(client_trfee) AS trfee, sum(client_decl) AS authfee
                FROM badtransactions
                WHERE trans_datetime >= '$_parm3'::timestamp with time zone AND currency_code > 0 AND
                trans_datetime &lt; ('$_parm4'::date + interval '1 day')::timestamp with time zone AND
                client_id IN ($_parm5)
                GROUP BY currency_code
                ORDER BY currency_code
                )
                ) AS foo
                WHERE currency_code > 0
                GROUP BY currency_code
                ORDER BY currency_code
            </request>
            <group step="10">
                <groupliteral col="1" name="Type" row="9" header="no">Declined</groupliteral>
                <field col="2" name="Number" row="9" header="no"/>
                <field col="3" name="Amount" row="9" header="no"/>
                <field col="5" name="TrFee" row="9" header="no"/>
                <field col="6" name="AuFee" row="9" header="no"/>
                <formula col="9" name="Total" row="9" header="no">F$_cs+G$_cs</formula>
            </group>
        </sql>
        <sql cycle="yes">
            <group step="10">
                <groupliteral col="1" name="Type" row="13" header="no">To transfer</groupliteral>
                <formula col="9" name="Total" row="13" header="no">
                    INDIRECT("J" &amp; ($_ss+5))+
                    INDIRECT("J" &amp; ($_ss+6))+
                    INDIRECT("J" &amp; ($_ss+7))-
                    INDIRECT("J" &amp; ($_ss+8))-
                    INDIRECT("J" &amp; ($_ss+9))-
                    INDIRECT("J" &amp; ($_ss+10))-
                    INDIRECT("J" &amp; ($_ss+11))+
                    INDIRECT("J" &amp; ($_ss+12))
                </formula>
            </group>
        </sql>
    </report>
</book>